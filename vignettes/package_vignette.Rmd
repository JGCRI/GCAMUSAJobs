---
title: "package_vignette"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{package_vignette}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  warning = FALSE,
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup, warning=FALSE}
library(GOFREE)
library(dplyr)
library(ggplot2)
library(knitr)
```

# Step1: read in GCAM output
This step reads in GCAM output of interest in alternative file types.

Use a local GCAM output database 
```{r Step1, warning=FALSE}
prj <- GOFREE::ReadGCAM(filetype = 'db',
                        input_path = "C:/GODEEP/GCAM7/output",
                        db_name = "database_basexdbGCAM-USA_Ref",
                        scen_name = "GCAM-USA_Ref", # this needs to match the scenario name specified in the DB
                        prj_name = "mydata.dat") # saved in working directory
```

Use a local project data
```{r, warning=FALSE}
prj <- GOFREE::ReadGCAM(filetype = 'prj',
                input_path = "C:/GODEEPPackage/GOFREE/",
                prj_name = "package.dat")
```
Use the default data (GCAM-USA 7.1 reference) in the package 
```{r}
prj <- GOFREE::ReadGCAM(filetype = 'prj',
                input_path = system.file("extdata", package = "GOFREE"),
                prj_name = "package.dat")

```

# Step2: obtain power generation outcome by activities
This step query electricity generation from GCAM output and calculate the electricity generation by activities, takes about 20 seconds for a scenario

```{r Step2}
EJ_activity <- GOFREE::GCAM_EJ(prj)

```

Show a subset of the outcomes
```{r}
head(EJ_activity %>% filter(region == "TX", Year == 2050), 10)
head(EJ_activity %>% filter(region == "CA", Year == 2050), 10)
```

# Step3: obtain capacity by activities
This step derive the undrlying capacity activities based on electricity generation by activities

```{r}
GW_activity <- GOFREE::GCAM_GW(EJ_activity)
```


Show a subset of the outcomes
```{r}
head(GW_activity %>% filter(region == "TX", Year == 2050), 10)
head(GW_activity %>% filter(region == "CA", Year == 2050), 10)
```

# Step4: obtain job by activities
This step calculate job by tech

```{r}
JOB_activity <- GOFREE::GCAM_JOB(GW_activity)
JOB_activity2 <- GOFREE::GCAM_JOB(GW_activity, "Net")
JOB_activity3 <- GOFREE::GCAM_JOB(GW_activity, "total")
```


Show a subset of the outcomes
```{r}
head(JOB_activity %>% filter(region == "TX", Year == 2050), 10)
head(JOB_activity %>% filter(region == "CA", Year == 2050), 10)
```


# Step5: plot employment factor
This step plots the employment factor from JEDI. Each text label represents the level of a state.

```{r, warning=FALSE, fig.width=18, fig.height=6}
GOFREE::PLOT_EF()
```

# Step6: plot capacity activities 
This step plots the capacity activities. Red + Green is the total capacity in operation in a year, where red bars denote the capacity in operation that is newly installed in a given year, and green denotes the capacity in operation that were build in the past; Blue bars denote the capacity change due to retirement. 

```{r, warning=FALSE, fig.width=12, fig.height=6}
GOFREE::PLOT_GW(GW_activity)
```
# Step7: plot job by fuel and types
This step plots the national power sector direct job by fuel types and job types.

```{r, warning=FALSE, fig.width=12, fig.height=6}
GOFREE::PLOT_JOB(JOB_activity)
```
# Step8: plot job by job types
This step plots the national power sector direct job by job types.

```{r, warning=FALSE, fig.width=12, fig.height=6}
GOFREE::PLOT_JOB_TYPE(JOB_activity)
```

<!-- # Step9: job by state of a given year -->
<!-- This step maps out the state-level power sector direct job in a given year. -->

<!-- ```{r, warning=FALSE, fig.width=8, fig.height=6} -->
<!-- MAP_JOB(JOB_activity, 2020) -->
<!-- ``` -->
